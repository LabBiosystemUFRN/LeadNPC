rm(list = ls())
setwd("/home/clovis/Dropbox/Chumbo/")
load("./transcriptograms/allTranscriptogramers80")
load("./Data/tfs.RData")
#load("./Data/colors.RData")
load("./Data/colorsSB.RData")

figuras="figurasSB"

library(igraph)
library(RedeR)
library(transcriptogramer)
library(ggplot2)
library(purrr)
library(scales)

myTheme<-list()
zoom=30
myTheme$nestShape='ROUNDED_RECTANGLE'
myTheme$nestColor='#ffffff'
myTheme$nestLineWidth=4*(100/zoom)
myTheme$nestFontSize=24*(100/zoom)
myTheme$nestFontX=5
myTheme$nestFontY=10.8
myTheme$isAssign=TRUE


#intersecção dos clusteres
#load(file = "./Data/clusteres.RData")
load(file = "./Data/clusteresSB.RData")
c1<-clusteres$T1
c2<-clusteres$T2

# load(file='./Data/clusters12.RData')
load(file='./Data/clusters12SB.RData')

#intersecção dos clusteres
c1<-clusteres$T1
c2<-clusteres$T2

#cria dtf com intersecção
cltRef<-data.frame(c1=c1,c2=c2)

#load(file = "./Data/cl12.RData")
load(file = "./Data/cl12SB.RData")

#extrai genes para grupos 3 4 5 com base no 3 ref3
#inicioLoop ----
ref2=2

#maximo valor para o gráfico
maxval=max(table(cl12$Clust1[cl12$Clust1!=0]),
           table(cl12$Clust2[cl12$Clust2!=0]))
ref2=2
setwd(paste0("/home/clovis/Doutorado/Artigos/Chumbo/",figuras,"/Fig2/"))
# clusters 1 p/ 1----
#somente quem é 1 para 1 ou existe t2 sem t1
# boundary
#nccl<-c(2,3,4,5,6,7,9,10,11)
#sem boundary
nccl<-c(1,2,3,4,5,6,7,8,9,10,11,12,13,16,17,18,19,21,22,23,24,25,26)
for(ref2 in nccl){
  ref1<-cltRef$c1[cltRef$c2 ==  ref2]
  ref1<-na.exclude(ref1)
  
  #Lista genes em cada tempo
  genes1<-nrow(cl12[cl12$Clust1%in%ref1,])
  genes2<-nrow(cl12[cl12$Clust2%in%ref2,])

  m<-data.frame(i=c(1,2),genes=(c(genes1/1000,genes2/1000)))
  
  theme_new <- theme_set(theme_bw(base_size = 50))
  
  theme_new <- theme_update(axis.title.x = element_text(size =30),
                            axis.title.y = element_text(size =30),
                            axis.text.x = element_text(size =50),
                            axis.text.y = element_text(size =50))
  
  g <- ggplot(m, aes(as.factor(i),genes))+
    #scale_x_continuous(limits = c(0.5,2.5))+
      scale_y_continuous(limits = c(0,maxval/1000))+
    xlab("Interval")+
    ylab("Number of nodes (x 1000)")+
      geom_bar(stat = "identity", col=1, fill =color[[2]][ref2] , width = 0.45)
    
    plot(g)
    
    pdf(width = 11,height = 8.95,file = paste0("countGenesClust",ref2,".pdf"))
    suppressMessages(graphics::plot(g))
    dev.off()
 
}
#os que faltam em t2
unique(na.exclude(clusteres$T2[!clusteres$T2%in%nccl]))

#clusteres 14 e 15 t2 com 
# cluster 14 ----
ref21<-14
ref22<-15
ref1<-7

#Lista genes em cada tempo
genes21<-nrow(cl12[cl12$Clust1%in%ref21,])
genes22<-nrow(cl12[cl12$Clust1%in%ref22,])
genes1<-nrow(cl12[cl12$Clust1%in%ref1,])

m<-data.frame(i=c(1,2,2),
              genes=c(genes1/1000,
                      genes21/1000,
                      genes22/1000))

theme_new <- theme_set(theme_bw(base_size = 50))

theme_new <- theme_update(axis.title.x = element_text(size =30),
                          axis.title.y = element_text(size =30),
                          axis.text.x = element_text(size =50),
                          axis.text.y = element_text(size =50))

g <- ggplot()+
  scale_x_discrete(breaks = c(1,2))+
  scale_y_continuous(limits = c(0,maxval/1000))+
  xlab("Interval")+
  ylab("Number of nodes (x 1000)")+
  geom_bar(data=m[1,], aes(as.factor(i),genes),
           fill = c(color[[1]][ref1]),
           stat = "identity", col=1, width = 0.45)+
  geom_bar(data=m[2:3,], aes(as.factor(i),genes),
           fill = c(color[[2]][ref21],color[[2]][ref22]),
           stat = "identity", col=1, width = 0.45)+
  guides(fill=FALSE)

plot(g)

pdf(width = 11,height = 8.95,file = paste0("countGenesClust",ref21,".pdf"))
suppressMessages(graphics::plot(g))
dev.off()

# cluster 20 ----
ref2<-20
ref11<-11
ref12<-12
ref13<-13

#Lista genes em cada tempo
genes11<-nrow(cl12[cl12$Clust1%in%ref11,])
genes12<-nrow(cl12[cl12$Clust1%in%ref12,])
genes13<-nrow(cl12[cl12$Clust1%in%ref13,])
genes2<-nrow(cl12[cl12$Clust2%in%ref2,])

m<-data.frame(i=c(1,1,1,2),
              genes=c(genes11/1000,
                      genes12/1000,
                      genes13/1000,
                      genes2/1000))

theme_new <- theme_set(theme_bw(base_size = 50))

theme_new <- theme_update(axis.title.x = element_text(size =30),
                          axis.title.y = element_text(size =30),
                          axis.text.x = element_text(size =50),
                          axis.text.y = element_text(size =50))

g <- ggplot()+
  scale_x_discrete(breaks = c(1,2))+
  scale_y_continuous(limits = c(0,maxval/1000))+
  xlab("Interval")+
  ylab("Number of nodes (x 1000)")+
  geom_bar(data=m[1:3,], aes(as.factor(i),genes),
           fill = c(color[[1]][ref11],color[[1]][ref12],color[[1]][ref13]),
           stat = "identity", col=1, width = 0.45)+
  geom_bar(data=m[4,], aes(as.factor(i),genes),
           fill = color[[2]][ref2],
           stat = "identity", col=1, width = 0.45)+
  guides(fill=FALSE)

plot(g)

pdf(width = 11,height = 8.95,file = paste0("countGenesClust",ref2,".pdf"))
suppressMessages(graphics::plot(g))
dev.off()

#fim############################################################################  

#todas as GOs em resumo
terms<-c("GO:0071294","GO:0006357","GO:0006366","GO:0008214","GO:0010468",
         "GO:0016070","GO:0035821","GO:0043207","GO:0050792","GO:0006643",
         "GO:0008544","GO:0042157","GO:1903509","GO:0042158","GO:0006661",
         "GO:0006829","GO:0006882","GO:0055069","GO:0061088","GO:0071577",
         "GO:0006665","GO:0007600","GO:0008610","GO:0042221","GO:0050877",
         "GO:0051259","GO:0009308","GO:0016338","GO:0019748","GO:0042430",
         "GO:0042445","GO:0097164","GO:0006874","GO:0009165","GO:0010524",
         "GO:0042592","GO:0051049","GO:0051482","GO:0055074","GO:0062012",
         "GO:0019220","GO:0009187","GO:0051282","GO:0007416","GO:0044091",
         "GO:0002028","GO:0006022","GO:0051604","GO:0016485","GO:0051248",
         "GO:0099173","GO:0070588","GO:0002682","GO:0007166","GO:0009653",
         "GO:0019722","GO:0035556","GO:0051128","GO:0003013","GO:0006812",
         "GO:0007599","GO:0043254","GO:0097435","GO:0006464","GO:0016310",
         "GO:0046486","GO:0048666","GO:0050776","GO:0016050","GO:0017156",
         "GO:0048729","GO:0051648","GO:0061024","GO:0099003","GO:0009056",
         "GO:0072524","GO:0005975","GO:0010033","GO:0070887","GO:0006732",
         "GO:0009124","GO:1901575","GO:0031023","GO:0009719","GO:0009891",
         "GO:0014070","GO:0045935","GO:0007098","GO:0007219","GO:0033993",
         "GO:0044839","GO:0071704","GO:0000003","GO:0000079","GO:0002520",
         "GO:0006270","GO:0006354","GO:0006399","GO:0006418","GO:0006520",
         "GO:0006753","GO:0009057","GO:0015931","GO:0016072","GO:0019080",
         "GO:0031324","GO:0034470","GO:0042254","GO:0043038","GO:0043039",
         "GO:0043094","GO:0045786","GO:0048285","GO:0051169","GO:0051172",
         "GO:0051236","GO:0051301","GO:0051704","GO:0071166","GO:0072527",
         "GO:1901657","GO:0006807","GO:0006996","GO:0008152","GO:0044238",
         "GO:0007005","GO:0006839","GO:0070585","GO:0071806","GO:0072655",
         "GO:0006163","GO:0009123","GO:0015672","GO:0022411","GO:0043413",
         "GO:0006629","GO:0007186","GO:0030029","GO:0023052","GO:0016050",
         "GO:0007018","GO:0022406","GO:0051276","GO:0006119")

terms<-c("GO:0009889","GO:0031326","GO:0010556","GO:0090304","GO:0019219",
         "GO:0051252","GO:0006139","GO:0046483","GO:0006725","GO:0006351",
         "GO:1901360","GO:0031323","GO:0032774","GO:0034645","GO:0019438",
         "GO:2000112","GO:0018130","GO:0010468","GO:1901362","GO:0034641",
         "GO:0010467","GO:0009059","GO:0019222","GO:0006355","GO:0051171",
         "GO:0080090","GO:2001141","GO:0044271","GO:0034654","GO:0044249",
         "GO:1901576","GO:0060255","GO:0009058","GO:0006357","GO:0098542",
         "GO:0044260","GO:0043170","GO:0043207","GO:0006366","GO:0042742",
         "GO:0016070","GO:0009607","GO:0006304","GO:0003341","GO:0035082",
         "GO:1903901","GO:0035821","GO:0071294","GO:0048525","GO:0050792",
         "GO:0044237","GO:0008033","GO:0019079","GO:1903506","GO:0010529",
         "GO:0044364","GO:0043413","GO:0006486","GO:0070085","GO:0009101",
         "GO:0009100","GO:1901137","GO:1901135","GO:1903509","GO:0042339",
         "GO:0055085","GO:0031424","GO:0006643","GO:0046467","GO:0006811",
         "GO:0009247","GO:0070268","GO:0006022","GO:0018146","GO:0006829",
         "GO:0018149","GO:0097503","GO:0015711","GO:0071577","GO:0006497",
         "GO:0042158","GO:0008544","GO:0006506","GO:0006505","GO:0018196",
         "GO:0009913","GO:0043588","GO:0005975","GO:0006004","GO:0006882",
         "GO:0006664","GO:0006023","GO:0042157","GO:0016254","GO:0006026",
         "GO:0055069","GO:0009311","GO:0010876","GO:0006672","GO:0006665",
         "GO:0006661","GO:0044255","GO:0006952","GO:0046426","GO:1901264",
         "GO:0061088","GO:1901566","GO:0044273","GO:0006820","GO:1904893",
         "GO:0044272","GO:0080171","GO:0050954","GO:0016255","GO:0001894",
         "GO:0019317","GO:0015849","GO:0006790","GO:0072348","GO:0098656",
         "GO:0008654","GO:0019538","GO:0030855","GO:0006869","GO:0051259",
         "GO:0097400","GO:0043252","GO:0051238","GO:0015747","GO:0050912",
         "GO:0050953","GO:0006629","GO:0044255","GO:0008610","GO:0097164",
         "GO:0044281","GO:0055114","GO:0009593","GO:1901615","GO:0051606",
         "GO:0006805","GO:0006082","GO:0034754","GO:0071466","GO:0008202",
         "GO:1901568","GO:0042445","GO:0046470","GO:0007186","GO:0008654",
         "GO:0006665","GO:0051186","GO:0050906","GO:0045017","GO:0003008",
         "GO:1901685","GO:0006575","GO:1901570","GO:1901687","GO:0044283",
         "GO:0016053","GO:0006644","GO:1901617","GO:0030148","GO:0016042",
         "GO:0009410","GO:0051259","GO:0007606","GO:0006694","GO:0010876",
         "GO:0017144","GO:0050907","GO:0042446","GO:0046467","GO:0006790",
         "GO:0050911","GO:0090407","GO:0042430","GO:0006672","GO:0044106",
         "GO:0006749","GO:0007600","GO:0042221","GO:0009072","GO:0019637",
         "GO:0042737","GO:0007608","GO:0042537","GO:0046473","GO:0009308",
         "GO:0006690","GO:0036149","GO:1901616","GO:0006656","GO:0006956",
         "GO:0006654","GO:0006811","GO:0044272","GO:0010817","GO:0009310",
         "GO:0044242","GO:0033013","GO:0046513","GO:0006869","GO:0009812",
         "GO:0019184","GO:0015711","GO:0032787","GO:0006066","GO:0018958",
         "GO:0019748","GO:0070268","GO:0042180","GO:0006081","GO:0042436",
         "GO:0009074","GO:0001867","GO:1990748","GO:0035383","GO:0015849",
         "GO:0006703","GO:0046460","GO:0017001","GO:0030149","GO:0006637",
         "GO:0016137","GO:0098754","GO:0044282","GO:0034308","GO:0055085",
         "GO:2000257","GO:0050877","GO:0016338","GO:0015893","GO:0001676",
         "GO:0046471","GO:0071804","GO:0052646","GO:0009804","GO:0009111",
         "GO:0006063","GO:0044597","GO:0009226","GO:0044598","GO:0006568",
         "GO:0072376","GO:0032501","GO:0015889","GO:0015669","GO:1903317",
         "GO:0030638","GO:0009309","GO:1901571","GO:0043603","GO:0002920",
         "GO:0006658","GO:0009698","GO:0006766","GO:0051187","GO:0006569",
         "GO:0046337","GO:0046456","GO:0006646","GO:0042435","GO:0015850",
         "GO:0051604","GO:0072662","GO:0030449","GO:0071805","GO:0042133",
         "GO:0072663","GO:0006702","GO:0042135","GO:0042572","GO:0016054",
         "GO:0097237","GO:0071825","GO:0098742","GO:0042178","GO:0007186",
         "GO:0023052","GO:0007165","GO:0007154","GO:0003008","GO:0051716",
         "GO:0051606","GO:0009593","GO:0050896","GO:0070098","GO:0032501",
         "GO:0019932","GO:0019725","GO:0007610","GO:0050789","GO:0009187",
         "GO:0050794","GO:0009914","GO:0046058","GO:0065007","GO:0048878",
         "GO:0006171","GO:0050900","GO:0060326","GO:0010469","GO:0008217",
         "GO:0009190","GO:0015837","GO:0052652","GO:0035150","GO:0051049",
         "GO:0043062","GO:0002685","GO:0051174","GO:0046883","GO:0051050",
         "GO:0007200","GO:0030809","GO:0031280","GO:0055082","GO:0035587",
         "GO:0046903","GO:0050906","GO:0015844","GO:0051350","GO:0002790",
         "GO:0045980","GO:0051952","GO:0030808","GO:0006954","GO:0072507",
         "GO:1901137","GO:0050795","GO:0007187","GO:0002687","GO:0051046",
         "GO:0007606","GO:1903531","GO:0007631","GO:0031279","GO:0006939",
         "GO:0072503","GO:0043270","GO:0051339","GO:0044281","GO:1901293",
         "GO:1903530","GO:0007190","GO:0072522","GO:0043269","GO:0051051",
         "GO:0045933","GO:1903532","GO:0006140","GO:0030595","GO:0006811",
         "GO:0050432","GO:0055074","GO:0032103","GO:0006874","GO:0048520",
         "GO:1903524","GO:0051048","GO:0006468","GO:0019935","GO:0010562",
         "GO:0042330","GO:0006023","GO:0030814","GO:1901564","GO:0035813",
         "GO:0055065","GO:0050877","GO:0006793","GO:1900543","GO:0006952",
         "GO:0006875","GO:0042592","GO:0010524","GO:0070201","GO:0051674",
         "GO:0035815","GO:0009306","GO:0042749","GO:0010817","GO:0051937",
         "GO:0018298","GO:0015850","GO:0006164","GO:0035025","GO:0051272",
         "GO:0030817","GO:0006560","GO:0031401","GO:0032958","GO:0040017",
         "GO:0002430","GO:0046887","GO:0050433","GO:0051283","GO:0060359",
         "GO:0043408","GO:0048511","GO:0007600","GO:0048521","GO:0050880",
         "GO:0051954","GO:0006029","GO:0050920","GO:0007210","GO:1900372",
         "GO:0009260","GO:0090407","GO:0044062","GO:0030431","GO:0030799",
         "GO:0051953","GO:0023061","GO:0030204","GO:0050921","GO:0030206",
         "GO:0010919","GO:0046879","GO:0043949","GO:0042221","GO:0060402",
         "GO:0030199","GO:0019220","GO:0051345","GO:0051223","GO:0022401",
         "GO:0046888","GO:1900542","GO:0046717","GO:0060732","GO:0032940",
         "GO:0006768","GO:0006940","GO:0044057","GO:0006022","GO:0032098",
         "GO:0032270","GO:0007215","GO:0051259","GO:0008277","GO:0001934",
         "GO:0032879","GO:0045937","GO:0043112","GO:0007618","GO:0060456",
         "GO:0033555","GO:0099177","GO:0009152","GO:0072511","GO:0043410",
         "GO:0009987","GO:0040011","GO:0030800","GO:0044283","GO:0062012",
         "GO:0010513","GO:0030166","GO:0042220","GO:0042327","GO:0043647",
         "GO:1905145","GO:0065008","GO:0046579","GO:0050907","GO:0042753",
         "GO:1905144","GO:0035812","GO:0071377","GO:0009165","GO:0051047",
         "GO:0035929","GO:1902932","GO:0060191","GO:0009725","GO:0045761",
         "GO:0045938","GO:0051247","GO:0009101","GO:2001023","GO:0062014",
         "GO:2001025","GO:0007218","GO:0032101","GO:0006082","GO:0031399",
         "GO:0016054","GO:0007267","GO:0003018","GO:0033198","GO:0072347",
         "GO:0009583","GO:0010511","GO:0030815","GO:0030802","GO:0032268",
         "GO:0018126","GO:1901135","GO:0070838","GO:0070374","GO:0060193",
         "GO:0097529","GO:0090087","GO:0007586","GO:0051282","GO:0043084",
         "GO:0001932","GO:0006790","GO:0044060","GO:0097305","GO:0050650",
         "GO:1903831","GO:0001975","GO:0032890","GO:0023051","GO:0038063",
         "GO:0030072","GO:0007266","GO:0034762","GO:0051705","GO:0046951",
         "GO:0071674","GO:0015696","GO:0001525","GO:0010243","GO:0023058",
         "GO:0051057","GO:0051482","GO:0072521","GO:0046390","GO:0071318",
         "GO:0010107","GO:0050886","GO:0019229","GO:0032963","GO:0070371",
         "GO:0006561","GO:0009611","GO:0042713","GO:0055086","GO:0034694",
         "GO:0030803","GO:0015893","GO:0022610","GO:0043062","GO:0023052",
         "GO:0006022","GO:0007154","GO:0006023","GO:0006026","GO:0007010",
         "GO:0032501","GO:0007165","GO:0051179","GO:0050896","GO:0040011",
         "GO:0032502","GO:0032989","GO:0051716","GO:0006928","GO:0007264",
         "GO:0006793","GO:0043647","GO:0009611","GO:0032879","GO:0051056",
         "GO:0051604","GO:0071709","GO:1901564","GO:1901136","GO:0044091",
         "GO:0065008","GO:0036376","GO:0016486","GO:0099173","GO:0008037",
         "GO:0099068","GO:0051239","GO:0001941","GO:0050808","GO:0140115",
         "GO:0065009","GO:0048583","GO:0035418","GO:0030029","GO:0071804",
         "GO:0050435","GO:0010646","GO:1900046","GO:0032269","GO:0006883",
         "GO:0023051","GO:0072376","GO:0019538","GO:0034367","GO:0044255",
         "GO:0010248","GO:0030007","GO:1901615","GO:0097090","GO:0051668",
         "GO:0009653","GO:0048869","GO:0007158","GO:0000904","GO:0043113",
         "GO:0051270","GO:0006720","GO:0051248","GO:0007416","GO:0071825",
         "GO:0016485","GO:0006029","GO:0034637","GO:0019751","GO:0040012",
         "GO:0030029","GO:0006928","GO:0002576","GO:0007010","GO:0022610",
         "GO:0040011","GO:0032970","GO:0051179","GO:0032879","GO:0032989",
         "GO:0032940","GO:0097435","GO:0007264","GO:0023052","GO:0051056",
         "GO:0003012","GO:0006793","GO:0051270","GO:0032501","GO:0007154",
         "GO:0009611","GO:0007165","GO:0071840","GO:0034330","GO:0050896",
         "GO:0016043","GO:0040012","GO:0065007","GO:0034329","GO:0006887",
         "GO:0032502","GO:0030036","GO:0051258","GO:0050789","GO:0051128",
         "GO:0065008","GO:0048583","GO:0030049","GO:0023051","GO:0044087",
         "GO:0051716","GO:0070588","GO:0043062","GO:0010646","GO:0051017",
         "GO:0035556","GO:0016192","GO:0030155","GO:0051674","GO:0009653",
         "GO:0032535","GO:0019538","GO:0007229","GO:0048869","GO:0065009",
         "GO:0050817","GO:0006935","GO:0033275","GO:0048518","GO:0030048",
         "GO:0032268","GO:1900047","GO:1902903","GO:0051246","GO:0006468",
         "GO:0051239","GO:0044267","GO:0072511","GO:0051174","GO:0046903",
         "GO:1900046","GO:0030239","GO:0022604","GO:0051336","GO:0051261",
         "GO:0034765","GO:0048522","GO:0034762","GO:0044057","GO:0043412",
         "GO:0031333","GO:0060402","GO:0040017","GO:0070838","GO:0010927",
         "GO:0043242","GO:0010562","GO:0007599","GO:0090066","GO:0003008",
         "GO:0050819","GO:0098655","GO:0043244","GO:0055001","GO:0051130",
         "GO:1903035","GO:0002026","GO:0048646","GO:0051272","GO:1901564",
         "GO:0051604","GO:1990778","GO:0071526","GO:0032270","GO:0035637",
         "GO:0043254","GO:0045861","GO:0032102","GO:0050794","GO:1903779",
         "GO:0045017","GO:0031401","GO:0051918","GO:0006812","GO:0051247",
         "GO:1902531","GO:0003013","GO:0050879","GO:0008654","GO:0001775",
         "GO:0050793","GO:0048468","GO:0050818","GO:0030837","GO:0051493",
         "GO:0010604","GO:0051050","GO:0042692","GO:0051173","GO:0032272",
         "GO:0051283","GO:1903317","GO:0031034","GO:0008360","GO:0043269",
         "GO:0023052","GO:0007165","GO:0007154","GO:0006793","GO:0040011",
         "GO:0048583","GO:0006928","GO:0050896","GO:0051716","GO:0048584",
         "GO:0002376","GO:0048518","GO:0007167","GO:0018212","GO:0008283",
         "GO:0007166","GO:0006468","GO:0018108","GO:0002682","GO:0002764",
         "GO:0048522","GO:0043412","GO:0002768","GO:0023014","GO:0032502",
         "GO:0065007","GO:0046834","GO:0051674","GO:0018193","GO:0006935",
         "GO:0001775","GO:0042127","GO:0051179","GO:0051174","GO:0023051",
         "GO:0002433","GO:0044267","GO:0019538","GO:0002684","GO:0022610",
         "GO:0023056","GO:0010646","GO:0007169","GO:0030258","GO:0030029",
         "GO:0050789","GO:0051247","GO:0048869","GO:0006955","GO:0050794",
         "GO:0010647","GO:0050865","GO:0050776","GO:0051896","GO:0051897",
         "GO:0010562","GO:0007010","GO:0032270","GO:0002253","GO:0030155",
         "GO:0043491","GO:0032989","GO:0065009","GO:0030030","GO:0040012",
         "GO:0019637","GO:0051246","GO:0045017","GO:0051270","GO:0042330",
         "GO:0032501","GO:0036211","GO:0008654","GO:0032879","GO:0009967",
         "GO:1901564","GO:0046854","GO:0035556","GO:0032940","GO:0032268",
         "GO:0008219","GO:0044255","GO:0098657","GO:0000165","GO:0008284",
         "GO:0006644","GO:0051173","GO:0031401","GO:0006909","GO:0046486",
         "GO:0032970","GO:0050867","GO:0009605","GO:0046488","GO:0072593",
         "GO:0000904","GO:0031325","GO:0097485","GO:0016310","GO:0070848",
         "GO:0036092","GO:0030036","GO:0006464","GO:0006629","GO:0046777",
         "GO:0045785","GO:0050778","GO:0006952","GO:0071840","GO:0045730",
         "GO:0051128","GO:0051130","GO:0031399","GO:0010604","GO:0009653",
         "GO:0050793","GO:0032535","GO:0016192","GO:0051239","GO:0031294",
         "GO:0009719","GO:0060548","GO:0051272","GO:0051240","GO:0051258",
         "GO:0010941","GO:0040017","GO:0009893","GO:0016043","GO:0090407",
         "GO:1903409","GO:0006897","GO:0050817","GO:0050730","GO:0044344",
         "GO:0071774","GO:0045937","GO:0044087","GO:0071363","GO:0002429",
         "GO:0007275","GO:0048017","GO:1902533","GO:0038128","GO:0030032",
         "GO:0048519","GO:0009611","GO:0007163","GO:0038083","GO:0090066",
         "GO:0090130","GO:0043085","GO:0071310","GO:0007411","GO:0048523",
         "GO:0009987","GO:0070887","GO:0001525","GO:0009966","GO:0008610",
         "GO:0051094","GO:0002431","GO:0051781","GO:0010632","GO:0046903",
         "GO:0043303","GO:0022008","GO:0051347","GO:0097581","GO:0034629",
         "GO:0038093","GO:0048666","GO:0050866","GO:0048667","GO:0048858",
         "GO:0051338","GO:0061564","GO:2000377","GO:0010638","GO:0033674",
         "GO:0065008","GO:0050878","GO:0050808","GO:0001568","GO:0044089",
         "GO:0016050","GO:0061024","GO:0051179","GO:0016192","GO:0023052",
         "GO:0007154","GO:0006903","GO:0002376","GO:0051650","GO:0140029",
         "GO:0048284","GO:0048208","GO:0051173","GO:0032940","GO:0048518",
         "GO:0048522","GO:0010604","GO:0048583","GO:0001775","GO:0051648",
         "GO:0006793","GO:0065009","GO:0007165","GO:0048869","GO:0060627",
         "GO:0099504","GO:0051716","GO:0009893","GO:0032502","GO:0023051",
         "GO:0050793","GO:0099531","GO:0050896","GO:0032774","GO:0051656",
         "GO:0048489","GO:0031325","GO:0051239","GO:0010646","GO:0006468",
         "GO:0099003","GO:0048278","GO:0032879","GO:0016043","GO:0008219",
         "GO:0010941","GO:0007166","GO:0048584","GO:0071840","GO:0022406",
         "GO:0045893","GO:0046907","GO:0045595","GO:0031328","GO:0051649",
         "GO:0034654","GO:0010628","GO:0006906","GO:0065007","GO:0051174",
         "GO:1902680","GO:0045597","GO:0010033","GO:0008283","GO:1903508",
         "GO:0045935","GO:0051240","GO:0045944","GO:0009891","GO:0051247",
         "GO:0019438","GO:0007164","GO:0051246","GO:0032501","GO:0006900",
         "GO:0007267","GO:0031098","GO:1901362","GO:0051091","GO:0051254",
         "GO:0023056","GO:0070887","GO:0043473","GO:0017156","GO:0051640",
         "GO:0018130","GO:0050794","GO:0051090","GO:0010557","GO:0051094",
         "GO:0019538","GO:1903530","GO:0023014","GO:0051641","GO:0050789",
         "GO:1905114","GO:0010647","GO:0099643","GO:0045454","GO:0006955",
         "GO:0032268","GO:0036465","GO:0048268","GO:0080090","GO:0033059",
         "GO:0006470","GO:0051128","GO:1901700","GO:0033619","GO:0006351",
         "GO:0098657","GO:0002682","GO:0065008","GO:0048207","GO:2000027",
         "GO:0198738","GO:0090114","GO:0043405","GO:0022610","GO:2000026",
         "GO:0042089","GO:0001505","GO:0019882","GO:0010942","GO:0007269",
         "GO:0031399","GO:0031401","GO:0032270","GO:0043412","GO:0050865",
         "GO:0030182","GO:0006888","GO:1905330","GO:0048585","GO:0001816",
         "GO:0072583","GO:0015833","GO:0051707","GO:0080135","GO:0031175",
         "GO:0016082","GO:2000112","GO:0045165","GO:0009967","GO:0045184",
         "GO:0002521","GO:0042127","GO:0010562","GO:0048490","GO:1904948",
         "GO:0007275","GO:0023057","GO:0051171","GO:0070302","GO:0048194",
         "GO:0022008","GO:0002237","GO:0048199","GO:0007220","GO:0044260",
         "GO:0072659","GO:0048523","GO:0001738","GO:0010648","GO:0030155",
         "GO:0050690","GO:0000165","GO:0009966","GO:0042107","GO:0090175",
         "GO:0045937","GO:0099517","GO:0019222","GO:0044267","GO:0035493",
         "GO:0051241","GO:0030111","GO:0007034","GO:0032802","GO:0031629",
         "GO:0060255","GO:0048519","GO:0035459","GO:0006928","GO:0009607",
         "GO:0031323","GO:0090177","GO:0006836","GO:0006914","GO:0048193",
         "GO:0048729","GO:0050435","GO:0043112","GO:0048488","GO:0030100",
         "GO:0035333","GO:0090174","GO:0005976","GO:0097190","GO:0043067",
         "GO:0051403","GO:0042327","GO:0060548","GO:0048534","GO:0044340",
         "GO:0042886","GO:0046580","GO:0035567","GO:0008088","GO:0070304",
         "GO:0009605","GO:0045995","GO:0051767","GO:0099514","GO:1990778",
         "GO:0006896","GO:0045321","GO:0001906","GO:0006950","GO:0035725",
         "GO:0040007","GO:1901564","GO:0034219","GO:0036211","GO:0042094",
         "GO:0098693","GO:0031341","GO:0001101","GO:0042035","GO:0071542",
         "GO:0043068","GO:0010256","GO:0043408","GO:0016482","GO:0035556",
         "GO:0002684","GO:0050867","GO:0008104","GO:0032885","GO:0040011",
         "GO:0032526","GO:0061919","GO:0051769","GO:0051130","GO:0016051",
         "GO:1905276","GO:0007018","GO:0005975","GO:0072524","GO:0007017",
         "GO:0099111","GO:0072525","GO:0046031","GO:0016052","GO:0019362",
         "GO:0030705","GO:0006091","GO:0046939","GO:0042073","GO:0016053",
         "GO:0006090","GO:0035735","GO:0044782","GO:0051186","GO:1901292",
         "GO:0051156","GO:0006082","GO:0044262","GO:0006754","GO:0051188",
         "GO:0044283","GO:0006757","GO:0034404","GO:0009132","GO:0048193",
         "GO:0016051","GO:0005996","GO:0006890","GO:0009142","GO:0006928",
         "GO:0046434","GO:0006735","GO:0072522","GO:0009124","GO:0055114",
         "GO:0019882","GO:0002376","GO:0042866","GO:0009166","GO:0017144",
         "GO:0006096","GO:0019682","GO:0009145","GO:0055086","GO:0044281",
         "GO:0019363","GO:0070925","GO:0051179","GO:0009206","GO:0009056",
         "GO:0009201","GO:0006793","GO:0009168","GO:0031503","GO:0006002",
         "GO:0010033","GO:1901293","GO:0009127","GO:0051193","GO:0030509",
         "GO:0046907","GO:0044248","GO:0030811","GO:0044264","GO:1901361",
         "GO:0019637","GO:0046390","GO:0030031","GO:0006733","GO:1901135",
         "GO:0044282","GO:0034340","GO:0006007","GO:0006081","GO:0061919",
         "GO:0009156","GO:0034655","GO:0046365","GO:0072521","GO:0120031",
         "GO:0006098","GO:0019439","GO:0046364","GO:0006164","GO:0044270",
         "GO:0034341","GO:0005976","GO:1901137","GO:0070887","GO:0006955",
         "GO:0044275","GO:0006140","GO:0046835","GO:0009152","GO:0061621",
         "GO:0060271","GO:0002396","GO:0023051","GO:0046700","GO:0043901",
         "GO:0051649","GO:0010941","GO:0071357","GO:0006110","GO:0019693",
         "GO:0090407","GO:0060337","GO:0007178","GO:0046034","GO:0071772",
         "GO:1901575","GO:0010646","GO:0009607","GO:0043467","GO:0046394",
         "GO:0043470","GO:0022607","GO:0009063","GO:0009260","GO:0019320",
         "GO:0071773","GO:0023056","GO:0016192","GO:0051607","GO:0008219",
         "GO:0034637","GO:0051247","GO:0060333","GO:0021915","GO:0006003",
         "GO:0010604","GO:0006888","GO:0009226","GO:0030808","GO:0051704",
         "GO:0030388","GO:0010647","GO:0043123","GO:0006734","GO:0033692",
         "GO:0071346","GO:0051641","GO:0000272","GO:0006099","GO:0043456",
         "GO:0007249","GO:0006732","GO:0006753","GO:0043900","GO:0001539",
         "GO:0007030","GO:0034654","GO:0006109","GO:0030510","GO:0007166",
         "GO:0030030","GO:0019221","GO:0006165","GO:1903901","GO:0032270",
         "GO:0031329","GO:0000271","GO:0048518","GO:0044085","GO:0009894",
         "GO:0051656","GO:0032007","GO:0030813","GO:0065009","GO:0048583",
         "GO:0090092","GO:0009615","GO:0022406","GO:0044782","GO:0097711",
         "GO:0006367","GO:0009893","GO:0140056","GO:0070925","GO:0031325",
         "GO:0051173","GO:0010604","GO:0007049","GO:0030031","GO:0050789",
         "GO:0048518","GO:0030522","GO:0006352","GO:0080090","GO:0048522",
         "GO:0031023","GO:0022402","GO:0007017","GO:0060271","GO:0009755",
         "GO:0051640","GO:0045935","GO:0065007","GO:0051726","GO:0030030",
         "GO:0051254","GO:0009891","GO:0031328","GO:0050794","GO:0048519",
         "GO:0032774","GO:0019222","GO:0000086","GO:0023052","GO:0044839",
         "GO:0010557","GO:0007165","GO:0120031","GO:1901362","GO:0071383",
         "GO:1902680","GO:0010389","GO:0006351","GO:0051171","GO:0007154",
         "GO:0032502","GO:1903508","GO:0048869","GO:0000226","GO:0019438",
         "GO:0048523","GO:0018130","GO:0010628","GO:0031323","GO:0034654",
         "GO:0019216","GO:0007098","GO:1902749","GO:0071840","GO:0045893",
         "GO:0071407","GO:0060255","GO:0008219","GO:0019827","GO:0009719",
         "GO:0045595","GO:0016043","GO:0048545","GO:0007219","GO:0060759",
         "GO:0050793","GO:0010033","GO:0044260","GO:0050896","GO:2000112",
         "GO:0051716","GO:0098727","GO:0070887","GO:0007010","GO:0051239",
         "GO:0046785","GO:0045944","GO:0035329","GO:0022607","GO:0071396",
         "GO:0036211","GO:0044380","GO:0032886","GO:0007389","GO:0048584",
         "GO:0010921","GO:0008593","GO:0006820","GO:0006355","GO:0051174",
         "GO:0032501","GO:0019220","GO:0051641","GO:0051298","GO:0055088",
         "GO:0007099","GO:0001959","GO:0043412","GO:0009889","GO:2001141",
         "GO:0010941","GO:0031399","GO:0051301","GO:0080134","GO:0032922",
         "GO:0033993","GO:0044085","GO:0019219","GO:0044271","GO:0023056",
         "GO:0051276","GO:0006139","GO:0044237","GO:0008152","GO:0034641",
         "GO:0046483","GO:0006725","GO:0006325","GO:1901360","GO:0033554",
         "GO:0090304","GO:0006259","GO:0051236","GO:0007049","GO:0006974",
         "GO:0016071","GO:0015931","GO:0006403","GO:0016570","GO:0071824",
         "GO:0022402","GO:0051169","GO:0070647","GO:0071166","GO:0006807",
         "GO:0016458","GO:0016569","GO:0019222","GO:0006396","GO:0018205",
         "GO:0043170","GO:0007059","GO:0043043","GO:0031503","GO:0072331",
         "GO:0006950","GO:0065004","GO:0040029","GO:0051726","GO:0000075",
         "GO:0031497","GO:0006611","GO:0006260","GO:0006406","GO:0022613",
         "GO:0071826","GO:0031323","GO:0051641","GO:0010467","GO:0006996",
         "GO:0006281","GO:0006397","GO:0070727","GO:0044260","GO:0042795",
         "GO:0034645","GO:0033036","GO:0098781","GO:0071426","GO:0046907",
         "GO:0006368","GO:0051603","GO:0071705","GO:0034613","GO:1901796",
         "GO:0044265","GO:0006518","GO:0006354","GO:0022618","GO:0008380",
         "GO:0006412","GO:0006353","GO:0048519","GO:0000226","GO:0009987",
         "GO:0006886","GO:1901657","GO:0071840","GO:0051649","GO:0060249",
         "GO:0043038","GO:0009892","GO:0006753","GO:0006413","GO:0009059",
         "GO:0044238","GO:0045814","GO:1901659","GO:0045184","GO:0008213",
         "GO:0045786","GO:0060968","GO:0009058","GO:0065003","GO:0006417",
         "GO:0050684","GO:0051321","GO:0009116","GO:0051301","GO:1903046",
         "GO:0072395","GO:1903311","GO:0071702","GO:0051052","GO:0044249",
         "GO:0006220","GO:0043414","GO:1901576","GO:0032204","GO:0032259",
         "GO:0006342","GO:0034248","GO:0071704","GO:0051983","GO:0072527",
         "GO:0010608","GO:0000375","GO:0009262","GO:0043039","GO:2001022",
         "GO:0198738","GO:0048285","GO:0007275","GO:0031327","GO:0010629",
         "GO:0010033","GO:0016043","GO:0009411","GO:0006401","GO:0016226",
         "GO:0009163","GO:0009890","GO:0045047","GO:0032504","GO:0015833",
         "GO:0019692","GO:0034660","GO:0009314","GO:0044270","GO:0034249",
         "GO:0034622","GO:0048523","GO:0006405","GO:0006369","GO:0010558",
         "GO:0009147","GO:0017148","GO:0045815","GO:0002200","GO:0030522",
         "GO:0031056","GO:0000079","GO:0044786","GO:0046700","GO:0044271",
         "GO:0090305","GO:0043094","GO:0009112","GO:0034502","GO:0006998",
         "GO:0050657","GO:0009889","GO:0072528","GO:0032201","GO:0009628",
         "GO:0045637","GO:0031326","GO:0042770","GO:0009218","GO:0006418",
         "GO:0008543","GO:0032786","GO:0002520","GO:0030219","GO:0034655",
         "GO:0035601","GO:0009057","GO:0009148","GO:0000398","GO:0050000",
         "GO:0019439","GO:0019693","GO:0006613","GO:0032784","GO:0007281",
         "GO:0010556","GO:0043487","GO:0043484","GO:0080135","GO:0031324",
         "GO:0071897","GO:0006383","GO:0009220","GO:0043604","GO:0043543",
         "GO:0042451","GO:0098732","GO:0045787","GO:0016073","GO:0006457",
         "GO:1904837","GO:0010498","GO:0031163","GO:0031647","GO:0045652",
         "GO:0009208","GO:0010605","GO:0010212","GO:0017038","GO:0009209",
         "GO:0043631","GO:2000113","GO:1903706","GO:0046033","GO:0046390",
         "GO:0032479","GO:0042278","GO:0006221","GO:0006361","GO:0009755",
         "GO:1901361","GO:0034243","GO:0007276","GO:0051098","GO:0044419",
         "GO:0046040","GO:0043933","GO:0006360","GO:0051168","GO:0010948",
         "GO:0006293","GO:0031058","GO:0033044","GO:0032606","GO:0009301",
         "GO:0032481","GO:0033143","GO:0032781","GO:0019827","GO:0022414",
         "GO:0046039","GO:0006473","GO:0000003","GO:0036503","GO:0009263",
         "GO:0006352","GO:0032239","GO:0009261","GO:0043101","GO:0051984",
         "GO:0022412","GO:0097193","GO:0006796","GO:0001325","GO:0007130",
         "GO:0097428","GO:0051054","GO:0032968","GO:0072594","GO:0033365",
         "GO:0019941","GO:0034404","GO:0006612","GO:0009200","GO:0044766",
         "GO:0009154","GO:0015949","GO:0009129","GO:0070816","GO:0000280",
         "GO:0000083","GO:0008214","GO:0006275","GO:0006195","GO:0019081",
         "GO:0061013","GO:0000723","GO:0045023","GO:0098813","GO:0046385",
         "GO:0016055","GO:0046112","GO:1905114","GO:0001832","GO:0051096",
         "GO:0044257","GO:0072523","GO:1900264","GO:0071383","GO:0006188",
         "GO:0007140","GO:0070316","GO:0019080","GO:0051095","GO:0097329",
         "GO:0043687","GO:0051290","GO:0034656","GO:0003006","GO:0071407",
         "GO:0002377","GO:0009173","GO:0046940","GO:0034728","GO:0006402",
         "GO:0007131","GO:0006304","GO:0051028","GO:0070646","GO:0051985",
         "GO:2000116","GO:0001824","GO:0050953","GO:2001021","GO:0006144",
         "GO:0050686","GO:0072710","GO:0043462","GO:0104004","GO:0007569",
         "GO:0098727","GO:0006333","GO:0140013","GO:0046386","GO:0031498",
         "GO:0061641","GO:1902579","GO:1901409","GO:0006289","GO:0019934",
         "GO:0071103","GO:0009264","GO:0009113","GO:0090735","GO:0010501",
         "GO:0051053","GO:0030099","GO:0070507","GO:0018130","GO:0051172",
         "GO:0009130","GO:0000082","GO:0071359","GO:0044417","GO:0006183",
         "GO:0007127","GO:1900262","GO:0061982","GO:0019724","GO:1903313",
         "GO:0030163","GO:0075522","GO:0006475","GO:0016574","GO:0007093",
         "GO:0006997","GO:0006119","GO:0140053","GO:0006414","GO:0010257",
         "GO:0007005","GO:0046034","GO:0006415","GO:0032543","GO:0019693",
         "GO:0033108","GO:0006412","GO:1902600","GO:0006753","GO:0022900",
         "GO:0043604","GO:0006518","GO:0006091","GO:0034660","GO:0043043",
         "GO:0034470","GO:0072521","GO:0009141","GO:0009123","GO:0006839",
         "GO:0099132","GO:0022904","GO:0032984","GO:1990542","GO:1901566",
         "GO:0015980","GO:0055086","GO:0015986","GO:0006605","GO:0044743",
         "GO:0033365","GO:0045333","GO:0070125","GO:0071806","GO:0065002",
         "GO:0022411","GO:0009451","GO:0034641","GO:0022613","GO:0010467",
         "GO:0043603","GO:0043624","GO:0042776","GO:0099131","GO:0043933",
         "GO:0042254","GO:0017144","GO:0070126","GO:0071840","GO:0090662",
         "GO:0034622","GO:0055085","GO:0072594","GO:0017004","GO:0015672",
         "GO:0055114","GO:0000041","GO:0008286","GO:0007007","GO:0031365",
         "GO:0006396","GO:0006163","GO:0033572","GO:0018206","GO:0044237",
         "GO:0015985","GO:0009259","GO:0015919","GO:0019637","GO:0016043",
         "GO:0072512","GO:0090150","GO:0007006","GO:0032981","GO:0017183",
         "GO:0070585","GO:0018202","GO:0090501","GO:0001510","GO:1901135",
         "GO:0006474","GO:0009126","GO:0042255","GO:0050954","GO:0071705",
         "GO:0070525","GO:0090151","GO:0010608")


p<-enrichmentPlot(transc[[2]],nCores = T,GOIDs = terms) 

#reduzindo a quantidade de termos
terms2<-unique(p$data$Terms[p$data$y >=0.25])
p<-enrichmentPlot(transc[[2]],nCores = T,GOIDs = 
                    sub(pattern = ".+(GO:.{7}).+",replacement = "\\1",terms2))

cl<-na.exclude(unique(cl12$Clust2))
cl<-cl[order(cl)]
i=2
#p0<-p0
#p0<-ggplot()
p0<-p+ylim(-0.05,1)+xlim(-250,max(na.exclude(cl12$Position)))
for(i in cl){
  clmax<-max(na.exclude(cl12$Position[cl12[,4] == i]))
  clmin<-min(na.exclude(cl12$Position[cl12[,4] == i]))
  p0<-p0+
    # geom_rect(aes_string(xmin = clmin, xmax = clmax, ymin = -0.05, ymax = -0.01), 
    #              color= alpha(color[[2]][i],0.25),
    #              fill = alpha(color[[2]][i],0.25))+
    annotate(geom="text", x=(clmin+(clmax-clmin)/2), y=-0.025, 
             label=ifelse(i==13,1,i),
             color="black")+
    annotate(geom="rect", xmin = clmin, xmax = clmax, ymin = -0.05, ymax = -0.005,
           fill=color[[2]][i], alpha=0.25)
  
}
p0<-p0+  annotate(geom="text", x=-250, y=-0.025, label="Cluster",
                color="black", size=2)+
  coord_cartesian(ylim=c(0,1),
                  xlim=c(0,max(na.exclude(cl12$Position)))
                 ,expand = T)+
  #cluster 1
  annotate(geom="rect", xmin = transc[[2]]@clusters[[1]][1], 
           xmax = transc[[2]]@clusters[[1]][2], 
           ymin = -0.05, ymax = -0.005,
           fill=color[[2]][i], alpha=0.25)

  # geom_text(geom="text", x=-250, y=-0.025, label="Cluster",
  #             color="black", size=3.5)+
p0
setwd("/home/clovis/Dropbox/Chumbo/",figuras,"/")
pdf(width = 10,height = 7,file = paste0("EnrichTopGO.pdf"))
suppressMessages(graphics::plot(p0))
dev.off()


